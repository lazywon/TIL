# 스프링부트 프로젝트 구조

새로운 프로젝트에 투입되어 스프링부트를 이용하는 기회가 생겼고, 급한 일정으로 제대로 공부하지 못하고 개발부터 하게 되었다. 기존에 어느정도 개발되어 있는 프로젝트였기 때문에 일반적으로 많이 사용되는 구조와 현 프로젝트의 구조를 비교하고 각각의 용도에 대해 공부하고자 한다. 특히 개발하면서 헷갈렸던 DTO와 VO, DAO의 차이와 개념에 대해 명확히 짚어가고자 한다.

## MVC 패턴

스프링 프레임워크는 주로 MVC 패턴을 기반으로 웹앱을 구축한다. 따라서 스프링 패키지 구조를 알기 위해 기본적으로 MVC 패턴에 대해 이해해야 한다.
프로젝트 구성 시 Model, View, Controller의 역할로 구분하는 패턴이다.

- Model
  - 애플리케이션의 비즈니스 로직과 데이터 담당
  - 데이터의 상태와 조작 방법을 정의하며, 데이터 변경에 대한 처리 담당
  - 주로 데이터베이스와의 상호작용, 데이터 가공, 비즈니스 규칙을 수행
  - 뷰나 컨트롤러에 대해 알지 못하며, 독립적으로 존재함

* View
  - 사용자 인터페이스(UI) 담당
  - 모델의 데이터를 사용자가 이해하기 쉬운 형태로 표현하여 사용자에게 보여주는 역할과 사용자 입력을 모델로 전달하는 역할 수행
  - 모델의 변경 사항을 직접 알지 못하며, 모델로부터 데이터를 가져오기만 함
* Controller
  - 사용자 요청 처리 및 요청에 대응하는 적절한 모델과 뷰를 선택해 연결하는 역할. 사용자 입력을 받아 모델이나 뷰로 전달
  - 모델 데이터 갱신, 뷰 업데이트
  - 모델과 뷰의 역할 및 상호작용을 관리하여 서로의 영향을 최소화함
  - 즉, 모델이나 뷰의 변경을 모니터링하는 역할
* 특징
  - 애플리케이션 코드를 세가지 역할로 나누어 코드 유지 보수성과 재사용성 향상 및 복잡한 애플리케이션 개발을 용이하게 만든다.
  - 변경 발생 시 다른 역할에 영향 주지 않고 해당 역할만 수정하면 되므로 유지 보수와 개발 시간 단축시킬 수 있다.
  - 각 역할에 대한 단위 테스트 수행하기 쉽고 코드 재사용성이 높아진다.
  * 스프링에서 MVC 패턴 기반 개발을 지원하여, `@Controller`, `@Service`, `@Repository` 등 어노테이션을 이용하여 구성 요소 정의 및 관리가 가능하며, 스프링의 View Resolver를 사용하여 뷰를 관리할 수 있다.

## 일반적으로 사용되는 Spring Boot 프로젝트 구조

```
src/main/java
    ├── com.example.yourapp
    │   ├── controller
    │   ├── service
    │   ├── repository
    │   ├── entity
    │   ├── dto
    │   ├── vo
    │   └── YourApplication.java
    └── resources
        ├── static
        ├── templates
        └── application.properties (또는 application.yml)
```

### 각각의 폴더 역할

- controller
  - 클라이언트 요청 처리 담당하는 컨트롤러 클래스들이 위치
  - API 엔드포인트를 정의하고, 클라이언트 요청을 처리하여 비즈니스 로직을 호출하고, 응답을 반환하는 역할
- service
  - 비즈니스 로직 담당하는 서비스 클래스들이 위치
  - 컨트롤러로부터 받은 요청을 처리하고, 데이터베이스와의 상호작용을 담당하며, 데이터 가공 및 처리 수행
- repository
  - 데이터베이스와의 상호작용 처리하는 리포지토리 인터페이스 및 클래스들이 위치
  - 데이터베이스 CRUD 작업을 위한 메서드 정의
- entity
  - 데이터베이스 테이블과 매핑되는 JPA 엔티티 클래스들이 위치
  - 각 엔티티 클래스는 데이터베이스의 테이블과 매핑되는 필드들을 갖고 있음
- dto
  - 데이터 전송 객체(DTO) 클래스들이 위치
  - 컨트롤러와 서비스 간의 데이터 전송을 위해 사용되며, 필요한 필드들로 데이터를 캡슐화한다.
- vo
  - 값 객체(VO) 클래스들이 위치
  - 비즈니스 로직에서 사용되는 값을 객체로 표현하기 위해 사용되며, 주로 불변(immutable)하게 설계됨
- YourApplication.java
  - Spring Boot 애플리케이션의 메인 클래스로, 애플리케이션 실행하는 데 사용
  - `@SpringBootApplication` 어노테이션이 지정되어 있어 Spring Boot 자동 설정 활성화한다.
- resources
  - 프로젝트 리소스 파일들 위치
  - 정적 파일, 템플릿 파일, 환경 설정 파일 등이 저장
- static
  - 정적 리소스 파일(이미지, css, js..)이 위치
- templates
  - 서버 사이드 렌더링을 위한 템플릿 파일들이 위치
  - Tymeleaf, Freemarker 등 템플릿 엔진을 사용하는 경우 이 폴더에 템플릿 파일을 저장함
- application.properties 또는 application.yml
  - Spring Boot 애플리케이션의 설정 파일로, 데이터베이스 연결 정보나 서버 포트 등 설정을 정의

## 용어 정리

- DAO(Data Access Object)
  - 데이터베이스의 data에 접근하기 위한 객체
  - 데이터베이스 접근을 위한 로직과 비즈니스 로직을 분리하기 위해 사용한다.
- DTO(Data Transfer Object)
  - 계층 간 데이터 교환을 위해 사용하는 객체. 주로 비즈니스 계층과 표현 계층 사이에서 데이터 전달하는 용도로 사용.
  - 데이터베이스 레코드의 데이터를 매핑하기 위한 데이터 객체
  - DTO는 로직을 갖지 않고 데이터와 그 데이터에 접근을 위한 getter, setter만 갖는다.
  - Spring Boot에서는 DTO를 주로 컨트롤러(Controller)에서 사용하여 클라이언트로부터 전달받은 데이터를 가공하거나, 서비스(Service)로부터 전달받은 데이터를 클라이언트로 전달할 때 사용한다.
  - DTO 쓰는 이유?
    - layer 간(특시 서버 => 뷰)에 데이터를 넘길 때 DTO를 쓰면 편하다.
      - 프레임워크 내부에서 자동적으로 DTO가 인스턴스화되기 때문에 받아야 하는 곳에서 해당 인스턴스화된 DTO를 자료형으로 값을 받기만 하면 된다.
    - DTO에 필요한 데이터만을 포함하여 전달하므로써 클라이언트와 서버 간 데이터 전송을 단순화시킨다.
      - 네트워크 대역폭 절약, 전송 시간 단축
      - 불필요한 정보 노출될 일 없으므로 데이터 노출 최소화하여 보안 강화
    - 엔티티 객체에서 DTO로 변환하거나 DTO 기반으로 엔티티 객체를 생성할 수 있는 것과 같이, 비즈니스 로직과 데이터베이스 스키마 간 의존성을 줄일 수 있다.
    - DTO를 통해 API 인터페이스를 정의하고 문서화하는 것이 API 일관성 유지에 도움된다.
    - 클라이언트와 서버의 기능을 독립적으로 확장할 수 있다. 클라이언트에서 필요한 데이터를 추가로 요청하거나, 서버에서 추가적인 정보를 응답으로 제공하는 경우 DTO를 통해 해당 기능을 확장하기 쉽다.
- VO(Value Object)
  - 값 객체라고 불리며, 도메인 모델 안에서 특정 값을 표헌하기 위한 객체이다.
  - read-Only로 사용 도중에 값 변경이 불가능하며, 비즈니스 로직을 포함하지 않는다.
  - VO의 목적은 데이터를 그룹화하여 특정 값들을 하나의 객체로 사용하기 쉽게 만드는 것이다. 예를 들면, 사용자 정보를 담는 객체, 주소 정보를 담는 객체 등이 있다.
  - 데이터를 getter를 통해 가져온다는 점에서 DTO와 공통점이 있지만 VO는 getter만 가진 클래스로, setter를 활용해 가변적인 성격을 가진 DTO와 달리 VO는 불변의 성격을 갖는다는 점에 차이가 있다.

## 스프링 웹 계층

- Presentation Layer
  - Controller, View 포함하는 레이어로, 사용자와 시스템 사이 상호작용을 담당하는 레이어
  - 사용자 요청을 받아들이고, 비즈니스 로직 처리를 위해 서비스 레이어로 요청을 전달함
- Service Layer
  - 비즈니스 로직 처리 역할
  - 프레젠테이션 레이어로부터 요청을 받아 요청에 따른 비즈니스 로직을 실행하고, 도메인 레이어에서 필요한 데이터를 조회함
  - Service 레이어는 Persistence 레이어와 협력하여 트랜잭션 관리 및 데이터 처리를 수행한다.
- Persistence Layer
  - 데이터베이스와의 상호작용 담당
  - 데이터베이스에서 데이터 저장, 조회하고 엔티티와 데이터베이스 매핑을 처리함
- Domain Layer
  - 도메인 객체와 비즈니스 로직이 포함되는 역할
  - 비즈니스 요구 사항을 객체로 표현하고, 도메인 객체간의 관계와 상호작용을 다룸
  - 비즈니스 로직은 도메인 객체 안에 포함되어 있으며, 데이터 유효성 검사, 데이터 가공 등을 수행함
